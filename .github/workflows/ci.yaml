name: Build CI

on:
    push:
        branches:
            - test_12

concurrency:
    group: build-${{ github.ref }}
    cancel-in-progress: true

jobs:

    files_that_going_to_be_updated:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v3
              with:
                  fetch-depth: 2

            - name: Set up JDK 17
              uses: actions/setup-java@v3
              with:
                  distribution: 'temurin'
                  java-version: 17
            - id: 'auth'
              uses: 'google-github-actions/auth@v2'
              with:
                 credentials_json: '${{ secrets.PRIVATE_KEY_2 }}'

            - name: 'Set up Cloud SDK'
              uses: 'google-github-actions/setup-gcloud@v2'

            - name: 'Use gcloud CLI'
              env:
                  ACCESS_TOKEN: $(gcloud auth application-default print-access-token)
                  LA: "dd"
              run: |
                  gcloud info
                  echo ${{ env.LA }}
                  echo "2"
                  curl -X POST \
                  -H "Authorization: Bearer ${{ env.ACCESS_TOKEN }}" \
                  -H "Content-Type: application/json" \
                  -d '{
                      "query": "SELECT * FROM ML.PREDICT(MODEL `cache-node.mobile_build_metrics.model_builds_7`,( SELECT 3403 as tasksExecuted));",
                      "useLegacySql": false
                    }' \
                  https://bigquery.googleapis.com/bigquery/v2/projects/cache-node/queries




